<Window x:Class="XB2Midi.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:XB2Midi.Views"
        xmlns:converters="clr-namespace:XB2Midi.Converters"
        Title="XB2Midi" Height="800" Width="1000">
    <Window.Resources>
        <converters:MidiTypeToEnabledConverter x:Key="MidiTypeToEnabledConverter"/>
    </Window.Resources>
    <Grid>
        <TabControl>
            <!-- Commented out Devices tab
            <TabItem Header="Devices">
                <Grid>
                    <StackPanel Margin="10">
                        <GroupBox Header="MIDI Output Devices" Margin="0,0,0,10">
                            <StackPanel Margin="10">
                                <StackPanel Orientation="Horizontal" Margin="0,10,0,10">
                                    <ComboBox x:Name="GlobalDeviceComboBox" Width="300" Margin="0,0,10,0"/>
                                    <Button Content="Refresh" Click="RefreshDevicesButton_Click" Width="100"/>
                                    <Button Content="Test Note" Click="TestNoteButton_Click" Width="100" Margin="10,0,0,0"/>
                                </StackPanel>
                                <TextBlock x:Name="ModeDisplay" Text="Mode: Basic" FontWeight="Bold" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Controller Status">
                            <TextBlock x:Name="ControllerStatus" Text="Controller: Disconnected" Padding="10"/>
                        </GroupBox>
                        
                        <GroupBox Header="MIDI Activity">
                            <ListBox x:Name="MidiActivityLog" Height="200" Margin="10"/>
                        </GroupBox>
                    </StackPanel>
                </Grid>
            </TabItem>
            -->
            
            <!-- Basic Mode Mapping Tab -->
            <TabItem Header="Basic Mode Mapping" x:Name="BasicMappingTab">
                <Grid>
                    <StackPanel Margin="10">
                        <TextBlock Text="Map controller inputs to MIDI messages" 
                                 FontWeight="Bold" Margin="0,0,0,10"/>
                        
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Text="Controller Input:" Grid.Row="0" Grid.Column="0" Margin="0,0,10,10"/>
                            <ComboBox x:Name="ControllerInputComboBox" Grid.Row="0" Grid.Column="1" Margin="0,0,0,10">
                                <!-- Controller inputs -->
                            </ComboBox>
                            
                            <TextBlock Text="MIDI Message Type:" Grid.Row="1" Grid.Column="0" Margin="0,0,10,10"/>
                            <ComboBox x:Name="MidiTypeComboBox" Grid.Row="1" Grid.Column="1" Margin="0,0,0,10" 
                                     SelectionChanged="MidiTypeComboBox_SelectionChanged">
                                <ComboBoxItem Content="Note" IsSelected="True"/>
                                <ComboBoxItem Content="Control Change"/>
                                <ComboBoxItem Content="Pitch Bend"/>
                            </ComboBox>
                            
                            <TextBlock Text="MIDI Device:" Grid.Row="2" Grid.Column="0" Margin="0,0,10,10"/>
                            <ComboBox x:Name="BasicMappingDeviceComboBox" Grid.Row="2" Grid.Column="1" Margin="0,0,0,10"/>
                            
                            <TextBlock Text="MIDI Channel (1-16):" Grid.Row="3" Grid.Column="0" Margin="0,0,10,10"/>
                            <TextBox x:Name="MidiChannelTextBox" Grid.Row="3" Grid.Column="1" Margin="0,0,0,10" Text="1"/>
                            
                            <TextBlock Text="MIDI Value (0-127):" Grid.Row="4" Grid.Column="0" Margin="0,0,10,10"/>
                            <TextBox x:Name="MidiValueTextBox" Grid.Row="4" Grid.Column="1" Margin="0,0,0,10"/>
                        </Grid>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,20">
                            <Button Content="Add Mapping" Click="AddMapping_Click" Width="120"/>
                            <Button Content="Refresh Devices" Click="RefreshDevicesButton_Click" Margin="10,0,0,0" Width="120"/>
                        </StackPanel>

                        <!-- Mappings List -->
                        <TextBlock Text="Current Mappings:" FontWeight="Bold" Margin="0,0,0,5"/>
                        <ListView x:Name="MappingsListView" Height="200">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="Controller Input" Width="120" DisplayMemberBinding="{Binding ControllerInput}"/>
                                    <GridViewColumn Header="Message Type" Width="120" DisplayMemberBinding="{Binding MessageType}"/>
                                    <GridViewColumn Header="MIDI Device" Width="200" DisplayMemberBinding="{Binding MidiDeviceName}"/>
                                    <GridViewColumn Header="Channel" Width="60" DisplayMemberBinding="{Binding DisplayChannel}"/>
                                    <GridViewColumn Header="Value" Width="60" DisplayMemberBinding="{Binding DisplayValue}"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                            <Button Content="Save Mappings" Click="SaveMappings_Click" Width="120"/>
                            <Button Content="Load Mappings" Click="LoadMappings_Click" Margin="10,0,0,0" Width="120"/>
                            <Button Content="Delete Selected" Click="DeleteMapping_Click" Margin="10,0,0,0" Width="120"/>
                        </StackPanel>

                        <!-- Controller Status -->
                        <GroupBox Header="Controller Status" Margin="0,10,0,0">
                            <TextBlock x:Name="ControllerStatus" Text="Controller: Disconnected" Padding="10"/>
                        </GroupBox>

                        <!-- MIDI Activity -->
                        <GroupBox Header="MIDI Activity" Margin="0,10,0,0">
                            <ListBox x:Name="MidiActivityLog" Height="200" Margin="10"/>
                        </GroupBox>

                        <!-- Mode Display -->
                        <TextBlock x:Name="ModeDisplay" Text="Mode: Basic" FontWeight="Bold" Margin="0,10,0,0"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Chord Mode Mapping Tab -->
            <TabItem x:Name="ChordMappingTab" Header="Chord">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Header with instructions -->
                    <Border Grid.Row="0" Background="#F0F0F0" Padding="10" Margin="0,0,0,10">
                        <TextBlock TextWrapping="Wrap">
                            <Bold>Chord Mode:</Bold> Press buttons to play root notes. Hold LB for minor triads, RB for major triads, and both for diminished chords.
                        </TextBlock>
                    </Border>
                    
                    <!-- Main content area -->
                    <Grid Grid.Row="1">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Left column - Controller mapping visualization -->
                        <Border Grid.Column="0" BorderThickness="1" BorderBrush="#CCCCCC" Margin="5" Padding="10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" FontWeight="Bold" Margin="0,0,0,10">Button Note Assignments</TextBlock>
                                
                                <Grid Grid.Row="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Face Buttons -->
                                    <GroupBox Grid.Row="0" Header="Face Buttons" Margin="0,5">
                                        <Grid Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Header row -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Button" FontWeight="Bold" Margin="5"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="Note" FontWeight="Bold" Margin="5"/>
                                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Channel" FontWeight="Bold" Margin="5"/>
                                            <TextBlock Grid.Row="0" Grid.Column="3" Text="Device" FontWeight="Bold" Margin="5"/>
                                            
                                            <!-- Y Button -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Y:" Margin="5"/>
                                            <ComboBox Grid.Row="1" Grid.Column="1" x:Name="YButtonNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="1" Grid.Column="2" x:Name="YChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="1" Grid.Column="3" x:Name="YDeviceCombo" Margin="5" Width="120"/>
                                            
                                            <!-- B Button -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="B:" Margin="5"/>
                                            <ComboBox Grid.Row="2" Grid.Column="1" x:Name="BButtonNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="2" Grid.Column="2" x:Name="BChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="2" Grid.Column="3" x:Name="BDeviceCombo" Margin="5" Width="120"/>
                                            
                                            <!-- X Button -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="X:" Margin="5"/>
                                            <ComboBox Grid.Row="3" Grid.Column="1" x:Name="XButtonNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="3" Grid.Column="2" x:Name="XChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="3" Grid.Column="3" x:Name="XDeviceCombo" Margin="5" Width="120"/>
                                            
                                            <!-- A Button -->
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="A:" Margin="5"/>
                                            <ComboBox Grid.Row="4" Grid.Column="1" x:Name="AButtonNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="4" Grid.Column="2" x:Name="AChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="4" Grid.Column="3" x:Name="ADeviceCombo" Margin="5" Width="120"/>
                                        </Grid>
                                    </GroupBox>
                                    
                                    <!-- D-Pad -->
                                    <GroupBox Grid.Row="1" Header="D-Pad" Margin="0,5">
                                        <Grid Margin="5">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Header row -->
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Button" FontWeight="Bold" Margin="5"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="Note" FontWeight="Bold" Margin="5"/>
                                            <TextBlock Grid.Row="0" Grid.Column="2" Text="Channel" FontWeight="Bold" Margin="5"/>
                                            <TextBlock Grid.Row="0" Grid.Column="3" Text="Device" FontWeight="Bold" Margin="5"/>
                                            
                                            <!-- DPad Up -->
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Up:" Margin="5"/>
                                            <ComboBox Grid.Row="1" Grid.Column="1" x:Name="DPadUpNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="1" Grid.Column="2" x:Name="DPadUpChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="1" Grid.Column="3" x:Name="DPadUpDeviceCombo" Margin="5" Width="120"/>
                                            
                                            <!-- DPad Right -->
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Right:" Margin="5"/>
                                            <ComboBox Grid.Row="2" Grid.Column="1" x:Name="DPadRightNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="2" Grid.Column="2" x:Name="DPadRightChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="2" Grid.Column="3" x:Name="DPadRightDeviceCombo" Margin="5" Width="120"/>
                                            
                                            <!-- DPad Down -->
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Down:" Margin="5"/>
                                            <ComboBox Grid.Row="3" Grid.Column="1" x:Name="DPadDownNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="3" Grid.Column="2" x:Name="DPadDownChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="3" Grid.Column="3" x:Name="DPadDownDeviceCombo" Margin="5" Width="120"/>
                                            
                                            <!-- DPad Left -->
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Left:" Margin="5"/>
                                            <ComboBox Grid.Row="4" Grid.Column="1" x:Name="DPadLeftNoteCombo" Margin="5"/>
                                            <ComboBox Grid.Row="4" Grid.Column="2" x:Name="DPadLeftChannelCombo" Margin="5" Width="60"/>
                                            <ComboBox Grid.Row="4" Grid.Column="3" x:Name="DPadLeftDeviceCombo" Margin="5" Width="120"/>
                                        </Grid>
                                    </GroupBox>
                                    
                                    <!-- Chord Type Reference -->
                                    <GroupBox Grid.Row="2" Header="Chord Type Reference" Margin="0,5">
                                        <Grid Margin="5">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <TextBlock Grid.Row="0" Grid.Column="0" Text="No Bumpers:" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="0" Grid.Column="1" Text="Root Note Only" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Left Bumper (LB):" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" Text="Minor Triad (1-b3-5)" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Double-Tap LB:" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="2" Grid.Column="1" Text="Minor 7th Chord (1-b3-5-b7)" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Triple-Tap LB:" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="3" Grid.Column="1" Text="Minor 9th Chord (1-b3-5-b7-9)" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Right Bumper (RB):" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="4" Grid.Column="1" Text="Major Triad (1-3-5)" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="5" Grid.Column="0" Text="Double-Tap RB:" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="5" Grid.Column="1" Text="Major 7th Chord (1-3-5-7)" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="6" Grid.Column="0" Text="Triple-Tap RB:" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="6" Grid.Column="1" Text="Major 9th Chord (1-3-5-7-9)" Margin="5"/>
                                            
                                            <TextBlock Grid.Row="7" Grid.Column="0" Text="Both Bumpers:" Margin="5" FontWeight="Bold"/>
                                            <TextBlock Grid.Row="7" Grid.Column="1" Text="Diminished Chord (1-b3-b5)" Margin="5"/>
                                        </Grid>
                                    </GroupBox>
                                </Grid>
                            </Grid>
                        </Border>
                        
                        <!-- Right column - Chord settings and test -->
                        <Border Grid.Column="1" BorderThickness="1" BorderBrush="#CCCCCC" Margin="5" Padding="10">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Octave Setting -->
                                <GroupBox Grid.Row="0" Header="Root Note Octave" Margin="0,5">
                                    <Grid Margin="5">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Octave:" VerticalAlignment="Center"/>
                                        <Slider Grid.Row="0" Grid.Column="1" x:Name="RootOctaveSlider" Minimum="2" Maximum="6" Value="4" 
                                                TickFrequency="1" TickPlacement="BottomRight" IsSnapToTickEnabled="True" Margin="10,0"/>
                                        <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding ElementName=RootOctaveSlider, Path=Value, StringFormat='{}{0:0}'}" 
                                                  VerticalAlignment="Center" Width="20" TextAlignment="Right"/>
                                        <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,5,0,0" TextWrapping="Wrap" 
                                                  Text="Adjusts the octave of all root notes. Higher values = higher pitch."/>
                                    </Grid>
                                </GroupBox>
                                
                                <!-- Velocity Setting -->
                                <GroupBox Grid.Row="1" Header="Chord Velocity" Margin="0,5">
                                    <Grid Margin="5">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Velocity:" VerticalAlignment="Center"/>
                                        <Slider Grid.Row="0" Grid.Column="1" x:Name="ChordVelocitySlider" Minimum="1" Maximum="127" Value="100" Margin="10,0"/>
                                        <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding ElementName=ChordVelocitySlider, Path=Value, StringFormat='{}{0:0}'}" 
                                                  VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                                        <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,5,0,0" TextWrapping="Wrap" 
                                                  Text="Controls how hard the chord is played (volume/intensity)."/>
                                    </Grid>
                                </GroupBox>
                                
                                <!-- Test Section -->
                                <GroupBox Grid.Row="2" Header="Test Chord" Margin="0,5">
                                    <Grid Margin="5">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Root Note:" Margin="5" VerticalAlignment="Center"/>
                                        <ComboBox Grid.Row="0" Grid.Column="1" x:Name="TestChordRootCombo" Margin="5"/>
                                        <StackPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="5" HorizontalAlignment="Center">
                                            <Button Content="Major" x:Name="TestMajorButton" Margin="5" Padding="5,3" Click="TestMajorChord_Click"/>
                                            <Button Content="Minor" x:Name="TestMinorButton" Margin="5" Padding="5,3" Click="TestMinorChord_Click"/>
                                            <Button Content="Maj7" x:Name="TestMajor7Button" Margin="5" Padding="5,3" Click="TestMajor7Chord_Click"/>
                                            <Button Content="Min7" x:Name="TestMinor7Button" Margin="5" Padding="5,3" Click="TestMinor7Chord_Click"/>
                                            <Button Content="Maj9" x:Name="TestMajor9Button" Margin="5" Padding="5,3" Click="TestMajor9Chord_Click"/>
                                            <Button Content="Min9" x:Name="TestMinor9Button" Margin="5" Padding="5,3" Click="TestMinor9Chord_Click"/>
                                            <Button Content="Dom7" x:Name="Test7thButton" Margin="5" Padding="5,3" Click="Test7thChord_Click"/>
                                            <Button Content="Dim" x:Name="TestDimButton" Margin="5" Padding="5,3" Click="TestDimChord_Click"/>
                                        </StackPanel>
                                    </Grid>
                                </GroupBox>
                                
                                <!-- Log Section -->
                                <GroupBox Grid.Row="3" Header="Chord Activity" Margin="0,5">
                                    <ListBox x:Name="ChordActivityLog" Margin="5"/>
                                </GroupBox>
                            </Grid>
                        </Border>
                    </Grid>
                    
                    <!-- Footer buttons -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="5">
                        <Button Content="Reset to Defaults" x:Name="ResetChordMappingsButton" Margin="5" Padding="10,5" Click="ResetChordMappings_Click"/>
                        <Button Content="Load Mappings" x:Name="LoadChordMappingsButton" Margin="5" Padding="10,5" Click="LoadChordMappings_Click"/>
                        <Button Content="Save Mappings" x:Name="SaveChordMappingsButton" Margin="5" Padding="10,5" Click="SaveChordMappings_Click"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Arpeggio Mode Mapping Tab -->
            <TabItem Header="Arpeggio Mode Mapping" x:Name="ArpeggioMappingTab">
                <Grid>
                    <TextBlock Text="Arpeggio Mode settings coming soon" 
                             FontWeight="Bold" HorizontalAlignment="Center"/>
                </Grid>
            </TabItem>
            
            <!-- Direct Mode Mapping Tab -->
            <TabItem Header="Direct Mode Mapping" x:Name="DirectMappingTab">
                <Grid>
                    <TextBlock Text="Direct mode mapping controls" 
                             FontWeight="Bold" HorizontalAlignment="Center"/>
                </Grid>
            </TabItem>
            
            <!-- Visualizer Tab -->
            <TabItem Header="Visualizer">
                <Grid>
                    <StackPanel>
                        <views:ControllerVisualizer x:Name="DebugVisualizer" Height="300"/>
                        <TextBlock x:Name="TestModeDisplay" Text="Mode: Basic" FontWeight="Bold" 
                                 Margin="10" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Test Tab -->
            <TabItem Header="Test">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Margin="10">
                        <views:InteractiveControllerVisualizer x:Name="TestVisualizer" Height="300"/>
                        <Slider x:Name="SpringBackRateSlider" Minimum="0.001" Maximum="0.1" Value="0.05"
                               ValueChanged="SpringBackRateSlider_ValueChanged"
                               TickFrequency="0.01" TickPlacement="BottomRight" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="Spring-back rate:" Margin="0,5,0,0"/>
                        <Slider x:Name="TriggerRateSlider" Minimum="1" Maximum="20" Value="10"
                               ValueChanged="TriggerRateSlider_ValueChanged"
                               TickFrequency="1" TickPlacement="BottomRight" IsSnapToTickEnabled="True"/>
                        <TextBlock Text="Trigger rate:" Margin="0,5,0,0"/>
                    </StackPanel>
                    
                    <Grid Grid.Row="1" Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Text="Test Results:" Grid.Row="0" FontWeight="Bold"/>
                        <ListBox x:Name="TestResultsLog" Grid.Row="1" Margin="0,5,0,0"/>
                    </Grid>
                </Grid>
            </TabItem>
            
            <!-- Log Tab -->
            <TabItem Header="Log">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal">
                        <Button Content="Clear Log" Click="ClearLog_Click" Margin="0,0,10,0"/>
                    </StackPanel>
                    <ListBox x:Name="InputLog" Grid.Row="1" Margin="0,10,0,0" 
                            KeyDown="InputLog_KeyDown"/>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>